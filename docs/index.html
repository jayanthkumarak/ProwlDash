<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProwlDash ‚Äî Documentation</title>
    <style>
        :root,
        [data-theme="dark"] {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1a1a24;
            --bg-hover: #22222e;
            --border: #2a2a38;
            --text-primary: #f0f0f5;
            --text-secondary: #9090a0;
            --text-muted: #606070;
            --accent-blue: #56B4E9;
            --accent-green: #009E73;
            --accent-orange: #E69F00;
        }

        [data-theme="light"] {
            --bg-primary: #f5f7fa;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e8ecf1;
            --bg-hover: #dfe4eb;
            --border: #d1d9e6;
            --text-primary: #1a1f36;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --accent-blue: #0072B2;
            --accent-green: #009E73;
            --accent-orange: #E69F00;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            padding: 60px 40px;
            text-align: center;
            border-bottom: 1px solid var(--border);
        }

        .header h1 {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .header .subtitle {
            color: var(--text-secondary);
            font-size: 18px;
            max-width: 600px;
            margin: 0 auto;
        }

        .header .version {
            display: inline-block;
            margin-top: 16px;
            padding: 4px 12px;
            background: var(--accent-blue);
            color: white;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        .nav {
            position: sticky;
            top: 0;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 12px 24px;
            display: flex;
            gap: 24px;
            justify-content: center;
            z-index: 100;
        }

        .nav a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: color 0.2s;
        }

        .nav a:hover {
            color: var(--accent-blue);
        }

        section {
            margin-bottom: 48px;
        }

        h2 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
        }

        h3 {
            font-size: 18px;
            margin: 24px 0 12px;
            color: var(--text-primary);
        }

        p {
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .code-block {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px 20px;
            margin: 16px 0;
            position: relative;
            overflow-x: auto;
        }

        .code-block code {
            font-family: 'SF Mono', Monaco, 'Consolas', monospace;
            font-size: 13px;
            color: var(--text-primary);
            display: block;
            white-space: pre;
        }

        .code-block .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--bg-hover);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 4px 10px;
            font-size: 11px;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
        }

        .code-block .copy-btn:hover {
            background: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        .code-block .copy-btn.copied {
            background: var(--accent-green);
            color: white;
            border-color: var(--accent-green);
        }

        .framework-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }

        .framework-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            transition: all 0.2s;
        }

        .framework-card:hover {
            border-color: var(--accent-blue);
            transform: translateY(-2px);
        }

        .framework-card .icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .framework-card .name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }

        .framework-card .id {
            font-family: monospace;
            font-size: 12px;
            color: var(--accent-blue);
            background: rgba(86, 180, 233, 0.1);
            padding: 2px 8px;
            border-radius: 4px;
            display: inline-block;
            margin-bottom: 8px;
        }

        .framework-card .desc {
            font-size: 13px;
            color: var(--text-muted);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
        }

        th,
        td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            background: var(--bg-tertiary);
        }

        td {
            font-size: 14px;
        }

        td code {
            background: var(--bg-tertiary);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
            font-size: 12px;
        }

        .alert {
            background: rgba(230, 159, 0, 0.1);
            border-left: 4px solid var(--accent-orange);
            padding: 16px 20px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .alert-title {
            font-weight: 600;
            color: var(--accent-orange);
            margin-bottom: 4px;
        }

        .theme-toggle {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            transition: all 0.2s;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .footer {
            text-align: center;
            padding: 40px 24px;
            border-top: 1px solid var(--border);
            color: var(--text-muted);
            font-size: 13px;
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>ProwlDash</h1>
        <p class="subtitle">Generate interactive compliance dashboards from Prowler security scans</p>
        <span class="version">v4.5.0</span>
    </div>

    <nav class="nav">
        <a href="#quick-start">Quick Start</a>
        <a href="#performance">Performance</a>
        <a href="#how-it-works">How It Works</a>
        <a href="#cli-reference">CLI Reference</a>
        <a href="#frameworks">Frameworks</a>
        <a href="#prowler">Prowler Integration</a>
        <a href="#troubleshooting">Troubleshooting</a>
    </nav>

    <div class="container">
        <section id="quick-start">
            <h2>üöÄ Quick Start</h2>
            <p>Generate a dashboard from your Prowler CSV export in seconds:</p>

            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>python3 prowldash.py your_prowler_report.csv</code>
            </div>

            <p>For multiple accounts or files:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>python3 prowldash.py account1.csv account2.csv account3.csv</code>
            </div>

            <p>Force a specific compliance framework:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>python3 prowldash.py --framework aws-well-architected report.csv</code>
        </section>

        <section id="performance">
            <h2>‚ö° Performance (V4.5)</h2>
            <p>V4.5 introduces significant performance improvements for processing multiple files and large scans.</p>

            <h3>Parallel Processing</h3>
            <p>When processing multiple CSV files, ProwlDash automatically distributes work across all available CPU
                cores. Speedup is <strong>linear with CPU cores</strong>: processing N files on an M-core machine
                completes in approximately 1/min(N,M) the sequential time.</p>

            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code># Processes all CSV files in parallel
prowldash data/*.csv</code>
            </div>

            <h3>Smart CSV Parsing</h3>
            <p>ProwlDash selects the optimal parser based on file size:</p>
            <table>
                <thead>
                    <tr>
                        <th>File Size</th>
                        <th>Parser</th>
                        <th>Reason</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>&lt; 10 MB</td>
                        <td><code>stdlib csv</code></td>
                        <td>2x faster for typical Prowler scans</td>
                    </tr>
                    <tr>
                        <td>‚â• 10 MB</td>
                        <td><code>pandas</code></td>
                        <td>C-optimized for enterprise-scale scans</td>
                    </tr>
                </tbody>
            </table>

            <p>To enable Pandas acceleration for large files:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>pip install pandas</code>
            </div>

            <h3>PyPy Compatibility</h3>
            <p>For additional speed, run ProwlDash with PyPy's JIT compiler:</p>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>pypy3 prowldash.py data/*.csv</code>
            </div>
        </section>

        <section id="how-it-works">
            <h2>How It Works</h2>
            <p>ProwlDash processes Prowler CSV exports through four stages to produce interactive dashboards.</p>

            <h3>1. Parse CSV Input</h3>
            <p>ProwlDash reads one or more CSV files exported from Prowler. It normalizes the data regardless of whether
                you used Prowler's main output format or compliance-specific format.</p>

            <h3>2. Detect Framework</h3>
            <p>The tool examines the CSV content and filename to determine which compliance framework applies. Detection
                checks the COMPLIANCE column for framework identifiers like "CIS-5.0" or "HIPAA", and falls back to
                filename patterns such as "cis_report.csv". You can override detection using the
                <code>--framework</code> flag.
            </p>

            <h3>3. Compute Statistics</h3>
            <p>ProwlDash aggregates findings by status (pass, fail, manual), severity (critical, high, medium, low),
                service, and account. When processing multiple scans from different dates, it computes delta information
                to highlight fixed issues and new failures.</p>

            <h3>4. Generate HTML</h3>
            <p>The final step embeds all data into a self-contained HTML file. The dashboard includes interactive
                charts, filterable tables, and detailed finding information. No external dependencies are required to
                view the output.</p>
        </section>

        <section id="cli-reference">
            <h2>üìñ CLI Reference</h2>

            <table>
                <thead>
                    <tr>
                        <th>Option</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>--framework</code>, <code>-f</code></td>
                        <td>Force specific compliance framework</td>
                        <td><code>--framework hipaa</code></td>
                    </tr>
                    <tr>
                        <td><code>--output</code>, <code>-o</code></td>
                        <td>Output directory path</td>
                        <td><code>-o ./reports</code></td>
                    </tr>
                    <tr>
                        <td><code>--no-timestamp</code></td>
                        <td>Skip timestamped subfolder creation</td>
                        <td><code>--no-timestamp</code></td>
                    </tr>
                    <tr>
                        <td><code>--list-frameworks</code></td>
                        <td>Show all supported framework IDs</td>
                        <td><code>--list-frameworks</code></td>
                    </tr>
                    <tr>
                        <td><code>--help</code>, <code>-h</code></td>
                        <td>Show detailed help</td>
                        <td><code>--help</code></td>
                    </tr>
                    <tr>
                        <td><code>--version</code>, <code>-v</code></td>
                        <td>Show version</td>
                        <td><code>--version</code></td>
                    </tr>
                </tbody>
            </table>

            <div class="alert">
                <div class="alert-title">üí° Tip: Framework IDs</div>
                <p style="margin:0">Use the exact ID from the table below when specifying <code>--framework</code>. For
                    example: <code>--framework pci-dss</code> or <code>--framework nist-800-53</code></p>
            </div>
        </section>

        <section id="frameworks">
            <h2>üè∑Ô∏è Supported Compliance Frameworks</h2>
            <p>Use these exact IDs with the <code>--framework</code> flag:</p>

            <div class="framework-grid">
                <div class="framework-card">
                    <div class="icon">üîí</div>
                    <div class="name">CIS AWS Benchmark</div>
                    <div class="id">cis</div>
                    <div class="desc">CIS Amazon Web Services Foundations Benchmark</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üõ°Ô∏è</div>
                    <div class="name">AWS FSBP</div>
                    <div class="id">fsbp</div>
                    <div class="desc">AWS Foundational Security Best Practices</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üèóÔ∏è</div>
                    <div class="name">Well-Architected</div>
                    <div class="id">aws-well-architected</div>
                    <div class="desc">AWS Well-Architected Framework</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üí≥</div>
                    <div class="name">PCI DSS</div>
                    <div class="id">pci-dss</div>
                    <div class="desc">Payment Card Industry Data Security Standard</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üè•</div>
                    <div class="name">HIPAA</div>
                    <div class="id">hipaa</div>
                    <div class="desc">Health Insurance Portability and Accountability Act</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üá™üá∫</div>
                    <div class="name">GDPR</div>
                    <div class="id">gdpr</div>
                    <div class="desc">General Data Protection Regulation</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üìã</div>
                    <div class="name">SOC 2</div>
                    <div class="id">soc2</div>
                    <div class="desc">Service Organization Control 2</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üèõÔ∏è</div>
                    <div class="name">NIST 800-53</div>
                    <div class="id">nist-800-53</div>
                    <div class="desc">NIST Special Publication 800-53</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üîê</div>
                    <div class="name">NIST CSF</div>
                    <div class="id">nist-csf</div>
                    <div class="desc">NIST Cybersecurity Framework</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üîè</div>
                    <div class="name">NIST 800-171</div>
                    <div class="id">nist-800-171</div>
                    <div class="desc">NIST SP 800-171 CUI Protection</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üåê</div>
                    <div class="name">ISO 27001</div>
                    <div class="id">iso27001</div>
                    <div class="desc">ISO/IEC 27001 Information Security</div>
                </div>
                <div class="framework-card">
                    <div class="icon">ü¶Ö</div>
                    <div class="name">FedRAMP</div>
                    <div class="id">fedramp</div>
                    <div class="desc">Federal Risk and Authorization Management</div>
                </div>
                <div class="framework-card">
                    <div class="icon">‚öîÔ∏è</div>
                    <div class="name">MITRE ATT&CK</div>
                    <div class="id">mitre-attack</div>
                    <div class="desc">Adversarial Tactics and Techniques</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üè¶</div>
                    <div class="name">FFIEC</div>
                    <div class="id">ffiec</div>
                    <div class="desc">Federal Financial Institutions Examination</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üá™üá∏</div>
                    <div class="name">ENS</div>
                    <div class="id">ens</div>
                    <div class="desc">Esquema Nacional de Seguridad (Spain)</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üá∞üá∑</div>
                    <div class="name">KISA ISMS-P</div>
                    <div class="id">kisa</div>
                    <div class="desc">Korea Internet & Security Agency ISMS-P</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üáÆüá≥</div>
                    <div class="name">RBI CSF</div>
                    <div class="id">rbi</div>
                    <div class="desc">Reserve Bank of India Cyber Security</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üá™üá∫</div>
                    <div class="name">NIS2</div>
                    <div class="id">nis2</div>
                    <div class="desc">EU Network and Information Security Directive 2</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üá©üá™</div>
                    <div class="name">BSI C5</div>
                    <div class="id">c5</div>
                    <div class="desc">German Cloud Computing Compliance Criteria</div>
                </div>
                <div class="framework-card">
                    <div class="icon">üíä</div>
                    <div class="name">GxP</div>
                    <div class="id">gxp</div>
                    <div class="desc">Good Practice Guidelines (Life Sciences)</div>
                </div>
            </div>
        </section>

        <section id="prowler">
            <h2>üîó Prowler Integration</h2>
            <p>Generate Prowler reports compatible with this dashboard:</p>

            <h3>Install Prowler</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>pip install prowler</code>
            </div>

            <h3>Generate Reports</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code># CIS Benchmark
prowler aws --compliance cis_5.0_aws -M csv

# AWS Foundational Security Best Practices
prowler aws --compliance aws_foundational_security_best_practices_aws -M csv

# HIPAA
prowler aws --compliance hipaa_aws -M csv

# PCI-DSS 4.0
prowler aws --compliance pci_dss_4.0_aws -M csv

# Well-Architected Security Pillar
prowler aws --compliance aws_well_architected_framework_security_pillar_aws -M csv</code>
            </div>

            <h3>List All Prowler Compliance Frameworks</h3>
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                <code>prowler aws --list-compliance</code>
            </div>

            <div class="alert">
                <div class="alert-title">üìù Note</div>
                <p style="margin:0">The dashboard generator auto-detects the framework from the CSV content. Use
                    <code>--framework</code> only when you need to override auto-detection.
                </p>
            </div>
        </section>

        <section id="troubleshooting">
            <h2>Troubleshooting</h2>

            <h3>"No CSV files provided" error</h3>
            <p>Ensure you pass at least one CSV file path as an argument. ProwlDash requires explicit file paths; it
                does not read from standard input.</p>

            <h3>Wrong framework detected</h3>
            <p>When ProwlDash selects an incorrect framework, override detection using the <code>--framework</code> flag
                with the appropriate framework ID. Run <code>prowldash --list-frameworks</code> to see available IDs.
            </p>

            <h3>Empty or missing data in dashboard</h3>
            <p>Verify your CSV uses Prowler's main output format, which includes the SEVERITY column.
                Compliance-specific exports may lack fields needed for complete dashboard statistics. Re-run Prowler
                with <code>-M csv</code> to generate the correct format.</p>

            <h3>Dashboard shows no failures</h3>
            <p>If your scan has no failing checks, the dashboard will show all findings as passed. This is expected
                behavior for compliant environments.</p>

            <h3>File encoding issues</h3>
            <p>ProwlDash expects UTF-8 encoded CSV files. If your CSV contains unusual characters or fails to parse,
                check the file encoding and convert to UTF-8 if necessary.</p>
        </section>
    </div>

    <div class="footer">
        <p>ProwlDash v4.5.0 ‚Äî Parallel Processing ‚Ä¢ Smart Parsing ‚Ä¢ PyPy Compatible</p>
    </div>

    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">üåô</button>

    <script>
        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme') || 'dark';
            const next = current === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', next);
            localStorage.setItem('docs-theme', next);
            document.querySelector('.theme-toggle').textContent = next === 'dark' ? 'üåô' : '‚òÄÔ∏è';
        }

        function copyCode(btn) {
            const code = btn.parentElement.querySelector('code').textContent;
            navigator.clipboard.writeText(code);
            btn.textContent = 'Copied!';
            btn.classList.add('copied');
            setTimeout(() => {
                btn.textContent = 'Copy';
                btn.classList.remove('copied');
            }, 2000);
        }

        // Apply saved theme
        const saved = localStorage.getItem('docs-theme') || 'dark';
        document.documentElement.setAttribute('data-theme', saved);
        document.querySelector('.theme-toggle').textContent = saved === 'dark' ? 'üåô' : '‚òÄÔ∏è';
    </script>
</body>

</html>