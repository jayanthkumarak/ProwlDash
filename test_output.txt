test_html_generation_integrity (tests.test_generation.TestDashboardGeneration.test_html_generation_integrity)
Verify that the generated HTML: ... FAIL
test_no_export_buttons (tests.test_generation.TestDashboardGeneration.test_no_export_buttons)
Ensure Export buttons are really gone (V5.1 Simplification). ... ok

======================================================================
FAIL: test_html_generation_integrity (tests.test_generation.TestDashboardGeneration.test_html_generation_integrity)
Verify that the generated HTML:
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/jayanthkumar/Documents/ProwlDash Dev/ProwlDash/tests/test_generation.py", line 34, in test_html_generation_integrity
    self.assertIn("const DATA = {", html_output, "JSON Data block missing from output")
AssertionError: 'const DATA = {' not found in '<!DOCTYPE html>\n<html lang="en">\n\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Security Compliance Dashboard - Indupro</title>\n    <style>\n        /* Colorblind-friendly palette based on Okabe-Ito\n           Reference: https://siegal.bio.nyu.edu/color-palette/\n           Avoids red/green confusion, uses blue/orange as primary contrast */\n        :root,\n        [data-theme="dark"] {\n            --bg-primary: #0a0a0f;\n            --bg-secondary: #12121a;\n            --bg-tertiary: #1a1a24;\n            --bg-hover: #22222e;\n            --border: #2a2a38;\n            --border-active: #56B4E9;\n            --text-primary: #f0f0f5;\n            --text-secondary: #9090a0;\n            --text-muted: #606070;\n\n            --accent-blue: #56B4E9;\n\n            --accent-green: #009E73;\n\n            --accent-red: #D55E00;\n\n            --accent-yellow: #F0E442;\n\n            --accent-purple: #CC79A7;\n\n            --accent-orange: #E69F00;\n\n\n            --severity-critical: #D55E00;\n\n            --severity-high: #E69F00;\n\n            --severity-medium: #F0E442;\n\n            --severity-low: #0072B2;\n            --severity-low: #0072B2;\n\n\n\n            --brand-primary: var(--accent-blue);\n            --brand-secondary: var(--accent-purple);\n        }\n\n        [data-theme="light"] {\n            --bg-primary: #f5f7fa;\n            --bg-secondary: #ffffff;\n            --bg-tertiary: #e8ecf1;\n            --bg-hover: #dfe4eb;\n            --border: #d1d9e6;\n            --border-active: #0072B2;\n            --text-primary: #1a1f36;\n            --text-secondary: #4a5568;\n            --text-muted: #718096;\n\n            --accent-blue: #0072B2;\n\n            --accent-green: #009E73;\n\n            --accent-red: #D55E00;\n\n            --accent-yellow: #B8860B;\n\n            --accent-purple: #CC79A7;\n\n            --accent-orange: #E69F00;\n\n            --severity-critical: #D55E00;\n            --severity-high: #E69F00;\n            --severity-medium: #B8860B;\n\n            --severity-low: #0072B2;\n\n\n            --brand-primary: var(--accent-blue);\n            --brand-secondary: var(--accent-purple);\n        }\n\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', system-ui, sans-serif;\n            background: var(--bg-primary);\n            color: var(--text-primary);\n            line-height: 1.5;\n        }\n\n        .header {\n            background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);\n            padding: 28px 40px;\n            border-bottom: 1px solid var(--border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n\n\n        .header h1 {\n            font-size: 24px;\n            font-weight: 600;\n            margin-bottom: 4px;\n        }\n\n        .header .subtitle {\n            color: var(--text-secondary);\n            font-size: 13px;\n        }\n\n        .header .subtitle strong {\n            color: var(--accent-blue);\n        }\n\n        .theme-toggle {\n            background: var(--bg-tertiary);\n            border: 1px solid var(--border);\n            border-radius: 8px;\n            padding: 8px 14px;\n            color: var(--text-secondary);\n            font-size: 13px;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            gap: 8px;\n            transition: all 0.2s;\n        }\n\n        .theme-toggle:hover {\n            background: var(--bg-hover);\n            color: var(--text-primary);\n            border-color: var(--accent-blue);\n        }\n\n        .theme-toggle svg {\n            width: 16px;\n            height: 16px;\n        }\n\n        .tab-bar {\n            background: var(--bg-secondary);\n            border-bottom: 1px solid var(--border);\n            padding: 0 40px;\n            display: flex;\n            gap: 0;\n        }\n\n        .tab-bar.hidden {\n            display: none;\n        }\n\n        .tab {\n            padding: 14px 24px;\n            font-size: 13px;\n            font-weight: 500;\n            color: var(--text-secondary);\n            cursor: pointer;\n            border-bottom: 2px solid transparent;\n            transition: all 0.2s;\n            display: flex;\n            align-items: center;\n            gap: 8px;\n        }\n\n        .tab:hover {\n            color: var(--text-primary);\n            background: var(--bg-hover);\n        }\n\n        .tab.active {\n            color: var(--accent-blue);\n            border-bottom-color: var(--accent-blue);\n        }\n\n        .tab .tab-count {\n            font-size: 11px;\n            padding: 2px 6px;\n            border-radius: 10px;\n            background: var(--bg-tertiary);\n            color: var(--text-muted);\n        }\n\n        .tab.active .tab-count {\n            background: rgba(74, 158, 255, 0.15);\n            color: var(--accent-blue);\n        }\n\n        .container {\n            max-width: 1440px;\n            margin: 0 auto;\n            padding: 28px 40px;\n        }\n\n        .section-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 14px;\n        }\n\n        .section-title {\n            font-size: 11px;\n            font-weight: 600;\n            color: var(--text-muted);\n            text-transform: uppercase;\n            letter-spacing: 1px;\n        }\n\n        .section-hint {\n            font-size: 11px;\n            color: var(--text-muted);\n            opacity: 0.7;\n        }\n\n        .btn-all {\n            background: var(--bg-tertiary);\n            border: 1px solid var(--border);\n            border-radius: 6px;\n            padding: 6px 14px;\n            color: var(--text-secondary);\n            font-size: 12px;\n            cursor: pointer;\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            transition: all 0.2s;\n        }\n\n        .btn-all:hover {\n            background: var(--bg-hover);\n            color: var(--text-primary);\n        }\n\n        .btn-all.hidden {\n            display: none;\n        }\n\n        .summary-grid {\n            display: grid;\n            grid-template-columns: repeat(5, 1fr);\n            gap: 14px;\n            margin-bottom: 16px;\n        }\n\n        .severity-grid {\n            display: grid;\n            grid-template-columns: repeat(4, 1fr);\n            gap: 14px;\n            margin-bottom: 32px;\n        }\n\n        .summary-card {\n            background: var(--bg-secondary);\n            border: 2px solid var(--border);\n            border-radius: 10px;\n            padding: 20px;\n            position: relative;\n            overflow: hidden;\n            cursor: pointer;\n            transition: all 0.2s;\n        }\n\n        .summary-card:hover {\n            border-color: var(--text-muted);\n            transform: translateY(-2px);\n        }\n\n        .summary-card.active {\n            border-color: var(--border-active);\n            box-shadow: 0 0 0 1px var(--border-active);\n        }\n\n        .summary-card::before {\n            content: \'\';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            height: 3px;\n        }\n\n        .summary-card.fail::before {\n            background: var(--accent-red);\n        }\n\n        .summary-card.pass::before {\n            background: var(--accent-green);\n        }\n\n        .summary-card.manual::before {\n            background: var(--accent-yellow);\n        }\n\n        .summary-card.fixed::before {\n            background: var(--accent-blue);\n        }\n\n        .summary-card.new-fail::before {\n            background: var(--accent-purple);\n        }\n\n        .summary-card.critical::before {\n            background: var(--severity-critical);\n        }\n\n        .summary-card.high::before {\n            background: var(--severity-high);\n        }\n\n        .summary-card.medium::before {\n            background: var(--severity-medium);\n        }\n\n        .summary-card.low::before {\n            background: var(--severity-low);\n        }\n\n        .summary-value {\n            font-size: 36px;\n            font-weight: 700;\n            letter-spacing: -1px;\n        }\n\n        .summary-card.fail .summary-value {\n            color: var(--accent-red);\n        }\n\n        .summary-card.pass .summary-value {\n            color: var(--accent-green);\n        }\n\n        .summary-card.manual .summary-value {\n            color: var(--accent-yellow);\n        }\n\n        .summary-card.fixed .summary-value {\n            color: var(--accent-blue);\n        }\n\n        .summary-card.new-fail .summary-value {\n            color: var(--accent-purple);\n        }\n\n        .summary-card.critical .summary-value {\n            color: var(--severity-critical);\n        }\n\n        .summary-card.high .summary-value {\n            color: var(--severity-high);\n        }\n\n        .summary-card.medium .summary-value {\n            color: var(--severity-medium);\n        }\n\n        .summary-card.low .summary-value {\n            color: var(--severity-low);\n        }\n\n        .summary-label {\n            font-size: 12px;\n            color: var(--text-secondary);\n            margin-top: 2px;\n        }\n\n        .summary-delta {\n            margin-top: 10px;\n            font-size: 11px;\n            padding: 3px 8px;\n            border-radius: 12px;\n            display: inline-block;\n        }\n\n        .summary-delta.positive {\n            background: rgba(61, 214, 140, 0.15);\n            color: var(--accent-green);\n        }\n\n        .summary-delta.negative {\n            background: rgba(255, 107, 107, 0.15);\n            color: var(--accent-red);\n        }\n\n        .summary-delta.neutral {\n            background: var(--bg-tertiary);\n            color: var(--text-muted);\n        }\n\n        .charts-row {\n            display: grid;\n            grid-template-columns: repeat(3, 1fr);\n            gap: 14px;\n            margin-bottom: 32px;\n        }\n\n        .chart-card {\n            background: var(--bg-secondary);\n            border: 1px solid var(--border);\n            border-radius: 10px;\n            padding: 20px;\n        }\n\n        .chart-title {\n            font-size: 13px;\n            font-weight: 600;\n            margin-bottom: 16px;\n        }\n\n        .bar-chart {\n            display: flex;\n            flex-direction: column;\n            gap: 10px;\n        }\n\n        .bar-item {\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n\n        .bar-label {\n            width: 90px;\n            font-size: 11px;\n            color: var(--text-secondary);\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n        }\n\n        .bar-track {\n            flex: 1;\n            height: 6px;\n            background: var(--bg-tertiary);\n            border-radius: 3px;\n            overflow: hidden;\n        }\n\n        .bar-fill {\n            height: 100%;\n            border-radius: 3px;\n        }\n\n        .bar-fill.fail {\n            background: var(--accent-red);\n        }\n\n        .bar-fill.critical {\n            background: var(--severity-critical);\n        }\n\n        .bar-fill.high {\n            background: var(--severity-high);\n        }\n\n        .bar-fill.medium {\n            background: var(--severity-medium);\n        }\n\n        .bar-fill.low {\n            background: var(--severity-low);\n        }\n\n        .bar-value {\n            width: 45px;\n            font-size: 11px;\n            text-align: right;\n            color: var(--text-muted);\n        }\n\n        .donut-container {\n            display: flex;\n            align-items: center;\n            gap: 24px;\n        }\n\n        .donut {\n            width: 120px;\n            height: 120px;\n            border-radius: 50%;\n            position: relative;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n\n        .donut-center {\n            position: absolute;\n            width: 76px;\n            height: 76px;\n            background: var(--bg-secondary);\n            border-radius: 50%;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n\n        .donut-center-value {\n            font-size: 22px;\n            font-weight: 700;\n        }\n\n        .donut-center-label {\n            font-size: 10px;\n            color: var(--text-muted);\n        }\n\n        .donut-legend {\n            display: flex;\n            flex-direction: column;\n            gap: 8px;\n        }\n\n        .legend-item {\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            font-size: 12px;\n        }\n\n        .legend-dot {\n            width: 8px;\n            height: 8px;\n            border-radius: 50%;\n        }\n\n        .legend-dot.fail {\n            background: var(--accent-red);\n        }\n\n        .legend-dot.pass {\n            background: var(--accent-green);\n        }\n\n        .legend-dot.manual {\n            background: var(--accent-yellow);\n        }\n\n        .filters-bar {\n            background: var(--bg-secondary);\n            border: 1px solid var(--border);\n            border-radius: 10px;\n            padding: 16px 20px;\n            margin-bottom: 16px;\n            display: flex;\n            gap: 12px;\n            flex-wrap: wrap;\n            align-items: flex-end;\n        }\n\n        .filter-group {\n            display: flex;\n            flex-direction: column;\n            gap: 4px;\n        }\n\n        .filter-group label {\n            font-size: 10px;\n            color: var(--text-muted);\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n        }\n\n        .filter-group select,\n        .filter-group input {\n            padding: 8px 12px;\n            background: var(--bg-primary);\n            border: 1px solid var(--border);\n            border-radius: 6px;\n            color: var(--text-primary);\n            font-size: 12px;\n            min-width: 130px;\n        }\n\n        .filter-group select:focus,\n        .filter-group input:focus {\n            outline: none;\n            border-color: var(--accent-blue);\n        }\n\n        .btn-reset {\n            padding: 8px 14px;\n            background: var(--bg-tertiary);\n            border: 1px solid var(--border);\n            border-radius: 6px;\n            color: var(--text-secondary);\n            font-size: 12px;\n            cursor: pointer;\n        }\n\n        .btn-reset:hover {\n            background: var(--bg-hover);\n            color: var(--text-primary);\n        }\n\n        .btn-link {\n            background: none;\n            border: none;\n            color: var(--brand-primary);\n            cursor: pointer;\n            font-size: 13px;\n            font-weight: 500;\n            padding: 4px 8px;\n            border-radius: 4px;\n        }\n\n        .btn-link:hover {\n            background: var(--bg-hover);\n            text-decoration: underline;\n        }\n\n        .filter-toggle {\n            display: inline-flex;\n            background: var(--bg-card);\n            border: 1px solid var(--border);\n            border-radius: 6px;\n            overflow: hidden;\n            margin-left: 10px;\n        }\n\n        .filter-toggle button {\n            background: transparent;\n            border: none;\n            padding: 6px 12px;\n            color: var(--text-secondary);\n            cursor: pointer;\n            font-size: 13px;\n            border-right: 1px solid var(--border);\n            transition: all 0.2s;\n        }\n\n        .filter-toggle button:last-child {\n            border-right: none;\n        }\n\n        .filter-toggle button.active {\n            background: var(--brand-primary);\n            color: #fff;\n        }\n\n        .table-section {\n            background: var(--bg-secondary);\n            border: 1px solid var(--border);\n            border-radius: 10px;\n\n        }\n\n        .table-header {\n            padding: 14px 20px;\n            border-bottom: 1px solid var(--border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            background: var(--bg-secondary);\n\n            position: sticky;\n\n            z-index: 11;\n        }\n\n        .table-header h2 {\n            font-size: 14px;\n            font-weight: 600;\n        }\n\n        .result-info {\n            font-size: 12px;\n            color: var(--text-muted);\n        }\n\n\n\n        .table-scroll::-webkit-scrollbar {\n            width: 6px;\n        }\n\n        .table-scroll::-webkit-scrollbar-track {\n            background: var(--bg-tertiary);\n        }\n\n        .table-scroll::-webkit-scrollbar-thumb {\n            background: var(--border);\n            border-radius: 3px;\n        }\n\n        table {\n            width: 100%;\n            border-collapse: collapse;\n            table-layout: fixed;\n        }\n\n        thead {\n            position: sticky;\n            top: 0;\n            background: var(--bg-secondary);\n\n            z-index: 10;\n            box-shadow: 0 1px 0 var(--border);\n\n        }\n\n        th {\n            padding: 10px 14px;\n            text-align: left;\n            font-size: 10px;\n            font-weight: 600;\n            color: var(--text-muted);\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n            border-bottom: 1px solid var(--border);\n            position: relative;\n            overflow: hidden;\n            resize: horizontal;\n        }\n\n        th:after {\n            content: \'\';\n            position: absolute;\n            right: 0;\n            top: 25%;\n            height: 50%;\n            width: 3px;\n            cursor: col-resize;\n            background: var(--border);\n            opacity: 0;\n            transition: opacity 0.2s;\n        }\n\n        th:hover:after {\n            opacity: 1;\n        }\n\n\n        th:nth-child(1) {\n            width: 100px;\n        }\n\n\n        th:nth-child(2) {\n            width: auto;\n            min-width: 300px;\n        }\n\n\n        th:nth-child(3) {\n            width: 80px;\n        }\n\n\n        th:nth-child(4) {\n            width: 80px;\n        }\n\n\n        th:nth-child(5) {\n            width: 120px;\n        }\n\n\n        th:nth-child(6) {\n            width: 90px;\n        }\n\n\n        td {\n            padding: 12px 14px;\n            font-size: 12px;\n            border-bottom: 1px solid var(--bg-tertiary);\n            vertical-align: top;\n            overflow: hidden;\n            text-overflow: ellipsis;\n        }\n\n        td:nth-child(2) {\n            white-space: normal;\n            word-wrap: break-word;\n        }\n\n\n        tbody tr {\n            cursor: pointer;\n            transition: background 0.1s;\n        }\n\n        tbody tr:hover {\n            background: var(--bg-hover);\n        }\n\n        .badge {\n            padding: 3px 8px;\n            border-radius: 4px;\n            font-size: 10px;\n            font-weight: 600;\n            text-transform: uppercase;\n        }\n\n        .badge.fail {\n            background: rgba(255, 107, 107, 0.15);\n            color: var(--accent-red);\n        }\n\n        .badge.pass {\n            background: rgba(61, 214, 140, 0.15);\n            color: var(--accent-green);\n        }\n\n        .badge.manual {\n            background: rgba(255, 217, 61, 0.15);\n            color: var(--accent-yellow);\n        }\n\n        .badge-sm {\n            padding: 2px 5px;\n            font-size: 9px;\n            margin-left: 4px;\n        }\n\n        .badge-sm.fixed {\n            background: rgba(74, 158, 255, 0.2);\n            color: var(--accent-blue);\n        }\n\n        .badge-sm.new {\n            background: rgba(220, 38, 38, 0.2);\n            color: #f87171;\n        }\n\n        .severity-badge {\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-size: 9px;\n            font-weight: 600;\n            text-transform: uppercase;\n        }\n\n        .severity-badge.critical {\n            background: rgba(239, 68, 68, 0.15);\n            color: var(--severity-critical);\n        }\n\n        .severity-badge.high {\n            background: rgba(249, 115, 22, 0.15);\n            color: var(--severity-high);\n        }\n\n        .severity-badge.medium {\n            background: rgba(234, 179, 8, 0.15);\n            color: var(--severity-medium);\n        }\n\n        .badge.l1 {\n            background: rgba(0, 158, 115, 0.15);\n            color: var(--accent-green);\n            border: 1px solid rgba(0, 158, 115, 0.3);\n        }\n\n        .badge.l2 {\n            background: rgba(230, 159, 0, 0.15);\n            color: var(--accent-orange);\n            border: 1px solid rgba(230, 159, 0, 0.3);\n        }\n\n        .badge.mitre {\n            background: rgba(204, 121, 167, 0.15);\n            color: var(--accent-purple);\n            cursor: pointer;\n            text-decoration: none;\n            transition: all 0.2s;\n        }\n\n        .badge.mitre:hover {\n            background: rgba(204, 121, 167, 0.3);\n            text-decoration: underline;\n        }\n\n        .meta-badges {\n            display: flex;\n            gap: 4px;\n            margin-top: 4px;\n            flex-wrap: wrap;\n        }\n\n        .severity-badge.low {\n            background: rgba(59, 130, 246, 0.15);\n            color: var(--severity-low);\n        }\n\n        .account-tag {\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-size: 10px;\n            font-weight: 500;\n        }\n\n        .account-tag.acct1 {\n            background: rgba(74, 158, 255, 0.15);\n            color: var(--accent-blue);\n        }\n\n        .account-tag.acct2 {\n            background: rgba(167, 139, 250, 0.15);\n            color: var(--accent-purple);\n        }\n\n        .account-tag.acct3 {\n            background: rgba(251, 146, 60, 0.15);\n            color: var(--accent-orange);\n        }\n\n        .account-tag.acct4 {\n            background: rgba(45, 212, 191, 0.15);\n            color: #2dd4bf;\n        }\n\n        .service-tag {\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-size: 10px;\n            background: var(--bg-tertiary);\n            color: var(--text-secondary);\n        }\n\n        .region-text {\n            font-family: monospace;\n            font-size: 10px;\n            color: var(--text-muted);\n        }\n\n        .check-id {\n            font-weight: 600;\n            color: var(--text-primary);\n        }\n\n        .check-desc {\n            color: var(--text-secondary);\n            font-size: 11px;\n            margin-top: 2px;\n            max-width: 300px;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n        }\n\n        #detailOverlay {\n            display: none;\n            position: fixed;\n            inset: 0;\n            background: rgba(0, 0, 0, 0.75);\n            z-index: 100;\n        }\n\n        #detailModal {\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            background: var(--bg-secondary);\n            border-radius: 10px;\n            width: 90%;\n            max-width: 860px;\n            max-height: 85vh;\n            overflow: auto;\n            border: 1px solid var(--border);\n        }\n\n        .modal-header {\n            padding: 16px 20px;\n            border-bottom: 1px solid var(--border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n\n        .modal-header h3 {\n            font-size: 15px;\n            font-weight: 600;\n        }\n\n        .modal-close {\n            background: none;\n            border: none;\n            color: var(--text-muted);\n            font-size: 22px;\n            cursor: pointer;\n        }\n\n        .modal-body {\n            padding: 20px;\n        }\n\n        .detail-grid {\n            display: grid;\n            grid-template-columns: repeat(2, 1fr);\n            gap: 16px;\n        }\n\n        .detail-block {\n            background: var(--bg-tertiary);\n            border-radius: 6px;\n            padding: 14px;\n        }\n\n        .detail-block.full {\n            grid-column: 1 / -1;\n        }\n\n        .detail-block h4 {\n            font-size: 10px;\n            color: var(--text-muted);\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n            margin-bottom: 8px;\n        }\n\n        .detail-block p {\n            font-size: 12px;\n            color: var(--text-secondary);\n            line-height: 1.5;\n        }\n\n        .detail-block pre {\n            background: var(--bg-primary);\n            padding: 12px;\n            border-radius: 4px;\n            font-family: monospace;\n            font-size: 11px;\n            color: var(--text-secondary);\n            white-space: pre-wrap;\n            word-break: break-word;\n            max-height: 250px;\n            overflow-y: auto;\n        }\n\n        .detail-block code {\n            background: var(--bg-primary);\n            padding: 1px 4px;\n            border-radius: 3px;\n            font-family: monospace;\n            font-size: 11px;\n        }\n\n        .detail-block a {\n            color: var(--accent-blue);\n            text-decoration: none;\n        }\n\n        .detail-block a:hover {\n            text-decoration: underline;\n        }\n\n        .empty-state {\n            text-align: center;\n            padding: 50px 20px;\n            color: var(--text-muted);\n        }\n\n        @media (max-width: 1100px) {\n            .summary-grid {\n                grid-template-columns: repeat(3, 1fr);\n            }\n\n            .severity-grid {\n                grid-template-columns: repeat(2, 1fr);\n            }\n\n            .charts-row {\n                grid-template-columns: 1fr 1fr;\n            }\n        }\n\n        @media (max-width: 700px) {\n            .container {\n                padding: 16px;\n            }\n\n            .summary-grid {\n                grid-template-columns: repeat(2, 1fr);\n            }\n\n            .severity-grid {\n                grid-template-columns: repeat(2, 1fr);\n            }\n\n            .charts-row {\n                grid-template-columns: 1fr;\n            }\n\n            .filters-bar {\n                flex-direction: column;\n            }\n\n            .detail-grid {\n                grid-template-columns: 1fr;\n            }\n        }\n    </style>\n</head>\n\n<body>\n    <div class="header">\n        <div class="header-left">\n            <h1 id="dashboardTitle">Security Compliance Dashboard</h1>\n            <div class="subtitle" id="headerSubtitle">Indupro AWS Accounts</div>\n        </div>\n        <button class="theme-toggle" id="themeToggle" title="Toggle dark/light mode">\n            <svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"\n                    d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />\n            </svg>\n            <svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"\n                style="display:none">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"\n                    d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />\n            </svg>\n            <span id="themeLabel">Light</span>\n        </button>\n    </div>\n\n    <div class="tab-bar hidden" id="tabBar" role="tablist" aria-label="Account Tabs">\n        <!-- Tabs will be dynamically generated -->\n    </div>\n    <div class="container" role="tabpanel">\n        <div class="section-header">\n            <div class="section-title">Executive Summary</div>\n            <div style="display:flex;align-items:center;gap:16px;">\n                <span class="section-hint" id="clickHint">Click cards to filter</span>\n                <button class="btn-all hidden" id="btnShowAll">Show All</button>\n            </div>\n        </div>\n        <div class="summary-grid" id="summaryGrid"></div>\n        <div class="section-header">\n            <div class="section-title">Severity Breakdown (Failures)</div>\n        </div>\n        <div class="severity-grid" id="severityGrid"></div>\n        <div class="section-title" style="margin-bottom:14px">Analysis</div>\n        <div class="charts-row" id="chartsRow"></div>\n        <div class="section-title" style="margin-bottom:14px">Detailed Findings</div>\n        <div class="filters-bar">\n            <div class="filter-group">\n                <label for="filterAccount">Account</label>\n                <select id="filterAccount">\n                    <option value="">All Accounts</option>\n                </select>\n            </div>\n            <div class="filter-group">\n                <label for="filterStatus">Status</label>\n                <select id="filterStatus">\n                    <option value="">All</option>\n                    <option value="FAIL">FAIL</option>\n                    <option value="PASS">PASS</option>\n                    <option value="MANUAL">MANUAL</option>\n                </select>\n            </div>\n            <div class="filter-group">\n                <label for="filterSeverity">Severity</label>\n                <select id="filterSeverity">\n                    <option value="">All</option>\n                    <option value="critical">Critical</option>\n                    <option value="high">High</option>\n                    <option value="medium">Medium</option>\n                    <option value="low">Low</option>\n                </select>\n            </div>\n            <div class="filter-group">\n                <label for="filterRegion">Region</label>\n                <select id="filterRegion">\n                    <option value="">All Regions</option>\n                </select>\n            </div>\n            <div class="filter-group">\n                <label for="filterService">Service</label>\n                <select id="filterService">\n                    <option value="">All Services</option>\n                </select>\n            </div>\n            <div class="filter-group">\n                <label for="filterSearch">Search</label>\n                <input type="text" id="filterSearch" placeholder="ID, resource...">\n            </div>\n\n            <button class="btn-reset" id="btnReset">Reset Filters</button>\n        </div>\n        <div class="table-section">\n            <div class="table-header">\n                <h2>Security Controls</h2>\n                <span class="result-info" id="resultInfo"></span>\n            </div>\n            <div class="table-scroll">\n                <table>\n                    <thead>\n                        <tr>\n                            <th>Check ID</th>\n                            <th>Title</th>\n                            <th>Status</th>\n                            <th>Severity</th>\n                            <th>Account</th>\n                            <th>Service</th>\n                        </tr>\n                    </thead>\n                    <tbody id="tableBody"></tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n    <div id="detailOverlay">\n        <div id="detailModal">\n            <div class="modal-header">\n                <h3 id="detailTitle"></h3>\n                <button class="modal-close" id="closeDetail">&times;</button>\n            </div>\n            <div class="modal-body" id="detailBody"></div>\n        </div>\n    </div>\n    <script>\n        const DATA = [{"ACCOUNTID":"123456789012","REGION":"us-east-1","REQUIREMENTS_ID":"1.4","REQUIREMENTS_DESCRIPTION":"Ensure that IAM access keys are rotated every 90 days or less","STATUS":"FAIL","STATUSEXTENDED":"User jdoe has access keys older than 90 days","REQUIREMENTS_ATTRIBUTES_SERVICE":"IAM","RESOURCEID":"arn:aws:iam::123456789012:user\\/jdoe","RESOURCENAME":"jdoe","REQUIREMENTS_ATTRIBUTES_REMEDIATIONPROCEDURE":"Rotate access keys","FRAMEWORK":"cis_2.0_aws","REQUIREMENTS_ATTRIBUTES_PROFILE":"Level 1","REQUIREMENTS_ATTRIBUTES_SECTION":"Identity and Access Management","REQUIREMENTS_ATTRIBUTES_RATIONALESTATEMENT":"Old keys increase risk"},{"ACCOUNTID":"123456789012","REGION":"us-east-1","REQUIREMENTS_ID":"2.1.1","REQUIREMENTS_DESCRIPTION":"Ensure S3 Bucket Policy is set to deny HTTP requests","STATUS":"PASS","STATUSEXTENDED":"Bucket policy denies HTTP","REQUIREMENTS_ATTRIBUTES_SERVICE":"S3","RESOURCEID":"arn:aws:s3:::secure-bucket","RESOURCENAME":"secure-bucket","REQUIREMENTS_ATTRIBUTES_REMEDIATIONPROCEDURE":"Add HTTPS enforcement policy","FRAMEWORK":"cis_2.0_aws","REQUIREMENTS_ATTRIBUTES_PROFILE":"Level 2","REQUIREMENTS_ATTRIBUTES_SECTION":"Storage","REQUIREMENTS_ATTRIBUTES_RATIONALESTATEMENT":"Unencrypted transport is risky"}];\n\n        let filtered = [];\n        let activeCardFilter = null;\n        let activeTab = \'all\';\n        const acctClasses = [\'acct1\', \'acct2\', \'acct3\', \'acct4\'];\n\n        function init() {\n            initTheme();\n\n\n            if (DATA.frameworkInfo) {\n                const fw = DATA.frameworkInfo;\n                const icon = fw.icon || \'üîç\';\n                const name = fw.full_name || fw.name || \'Security Compliance\';\n                document.title = name + \' Dashboard - Indupro\';\n                document.getElementById(\'dashboardTitle\').textContent = icon + \' \' + name + \' Dashboard\';\n            }\n\n            if (DATA.scanInfo) {\n                document.getElementById(\'headerSubtitle\').innerHTML =\n                    \'Indupro AWS Accounts | <strong>\' + DATA.scanInfo + \'</strong>\';\n            }\n\n\n            if (DATA.isMultiAccount) {\n                renderTabs();\n            }\n\n            renderSummary();\n            renderSeverity();\n            renderCharts();\n            populateFilters();\n            applyFilters();\n\n\n            [\'filterAccount\', \'filterStatus\', \'filterSeverity\', \'filterRegion\', \'filterService\', \'filterDelta\'].forEach(id => {\n                document.getElementById(id).addEventListener(\'change\', () => {\n                    clearCardFilter();\n                    applyFilters();\n                });\n            });\n            document.getElementById(\'filterSearch\').addEventListener(\'input\', debounce(() => {\n                clearCardFilter();\n                applyFilters();\n            }, 150));\n\n\n\n\n\n            document.getElementById(\'btnReset\').addEventListener(\'click\', resetFilters);\n            document.getElementById(\'btnShowAll\').addEventListener(\'click\', () => {\n                clearCardFilter();\n                resetFilters();\n            });\n            document.getElementById(\'closeDetail\').addEventListener(\'click\', closeModal);\n            document.getElementById(\'detailOverlay\').addEventListener(\'click\', e => {\n                if (e.target === e.currentTarget) closeModal();\n            });\n            document.getElementById(\'themeToggle\').addEventListener(\'click\', toggleTheme);\n\n\n            document.querySelectorAll(\'.summary-card\').forEach(card => {\n\n                card.setAttribute(\'tabindex\', \'0\');\n                card.setAttribute(\'role\', \'button\');\n                card.addEventListener(\'keydown\', (e) => {\n                    if (e.key === \'Enter\' || e.key === \' \') {\n                        e.preventDefault();\n                        card.click();\n                    }\n                });\n\n                card.addEventListener(\'click\', () => {\n                    document.getElementById(\'clickHint\').style.display = \'none\';\n                });\n            });\n        }\n\n        function initTheme() {\n            const saved = localStorage.getItem(\'theme\');\n            const theme = saved || \'dark\';\n            setTheme(theme);\n        }\n\n        function toggleTheme() {\n            const current = document.documentElement.getAttribute(\'data-theme\') || \'dark\';\n            const next = current === \'dark\' ? \'light\' : \'dark\';\n            setTheme(next);\n            localStorage.setItem(\'theme\', next);\n        }\n\n        function setTheme(theme) {\n            document.documentElement.setAttribute(\'data-theme\', theme);\n            const sunIcon = document.getElementById(\'sunIcon\');\n            const moonIcon = document.getElementById(\'moonIcon\');\n            const label = document.getElementById(\'themeLabel\');\n            if (theme === \'dark\') {\n                sunIcon.style.display = \'block\';\n                moonIcon.style.display = \'none\';\n                label.textContent = \'Light\';\n            } else {\n                sunIcon.style.display = \'none\';\n                moonIcon.style.display = \'block\';\n                label.textContent = \'Dark\';\n            }\n        }\n\n        function debounce(fn, ms) {\n            let t; return (...a) => { clearTimeout(t); t = setTimeout(() => fn(...a), ms); };\n        }\n\n        function renderTabs() {\n            const tabBar = document.getElementById(\'tabBar\');\n            tabBar.classList.remove(\'hidden\');\n\n            const accountIds = Object.keys(DATA.accounts);\n            let html = `<div class="tab ${(activeTab === \'all\' ? \'active\' : \'\')}" \n                data-tab="all" \n                onclick="setTab(\'all\')" \n                role="tab" \n                tabindex="0" \n                aria-selected="${activeTab === \'all\'}"\n                onkeydown="if(event.key===\'Enter\'||event.key===\' \')setTab(\'all\')">\n                <span>All Accounts</span>\n                <span class="tab-count">${DATA.stats.total}</span>\n            </div>`;\n\n            accountIds.forEach(acctId => {\n                const acct = DATA.accounts[acctId];\n                const isActive = activeTab === acctId;\n                const acctStats = DATA.accountStats[acctId] || { total: 0 };\n                html += `<div class="tab ${(isActive ? \'active\' : \'\')}" \n                    data-tab="${acctId}" \n                    onclick="setTab(\'${acctId}\')"\n                    role="tab" \n                    tabindex="0"\n                    aria-selected="${isActive}"\n                    onkeydown="if(event.key===\'Enter\'||event.key===\' \')setTab(\'${acctId}\')">\n                    <span>${acct.display || acct.name}</span>\n                    <span class="tab-count">${acctStats.total}</span>\n                </div>`;\n            });\n\n            tabBar.innerHTML = html;\n        }\n\n        function setTab(tabId) {\n            if (activeTab === tabId) return;\n\n            activeTab = tabId;\n\n\n            document.querySelectorAll(\'.tab\').forEach(t => {\n                const isActive = t.dataset.tab === tabId;\n                t.classList.toggle(\'active\', isActive);\n                t.setAttribute(\'aria-selected\', isActive);\n            });\n\n\n            clearCardFilter();\n\n\n            renderSummary();\n            renderSeverity();\n            renderCharts();\n            applyFilters();\n        }\n\n        function getActiveStats() {\n            if (activeTab === \'all\') {\n                return DATA.stats;\n            }\n            return DATA.accountStats[activeTab] || DATA.stats;\n        }\n\n        function getActiveFindings() {\n            if (activeTab === \'all\') {\n                return DATA.findings;\n            }\n            return DATA.findings.filter(f => f.acctId === activeTab);\n        }\n\n        function clearCardFilter() {\n            activeCardFilter = null;\n            document.querySelectorAll(\'.summary-card\').forEach(c => c.classList.remove(\'active\'));\n            document.getElementById(\'btnShowAll\').classList.add(\'hidden\');\n        }\n\n        function setCardFilter(type, value) {\n            if (activeCardFilter && activeCardFilter.type === type && activeCardFilter.value === value) {\n                clearCardFilter();\n                applyFilters();\n                return;\n            }\n            activeCardFilter = { type, value };\n            document.querySelectorAll(\'.summary-card\').forEach(c => c.classList.remove(\'active\'));\n            event.currentTarget.classList.add(\'active\');\n            document.getElementById(\'btnShowAll\').classList.remove(\'hidden\');\n\n\n            [\'filterAccount\', \'filterStatus\', \'filterSeverity\', \'filterRegion\', \'filterService\'].forEach(id => {\n                document.getElementById(id).value = \'\';\n            });\n            document.getElementById(\'filterSearch\').value = \'\';\n\n            applyFilters();\n        }\n\n        function renderSummary() {\n            const s = getActiveStats();\n            const cmp = DATA.stats.hasComparison && activeTab === \'all\';\n            document.getElementById(\'summaryGrid\').innerHTML = `\n                <div class="summary-card fail" onclick="setCardFilter(\'status\', \'FAIL\')">\n                    <div class="summary-value">${s.fail}</div>\n                    <div class="summary-label">Total Failures</div>\n                    ${cmp ? `<div class="summary-delta ${s.failDelta < 0 ? \'positive\' : s.failDelta > 0 ? \'negative\' : \'neutral\'}">\n                        ${s.failDelta > 0 ? \'+\' : \'\'}${s.failDelta} from previous\n                    </div>` : \'\'}\n                </div>\n                <div class="summary-card pass" onclick="setCardFilter(\'status\', \'PASS\')">\n                    <div class="summary-value">${s.pass}</div>\n                    <div class="summary-label">Total Passes</div>\n                    ${cmp ? `<div class="summary-delta ${s.passDelta > 0 ? \'positive\' : s.passDelta < 0 ? \'negative\' : \'neutral\'}">\n                        ${s.passDelta > 0 ? \'+\' : \'\'}${s.passDelta} from previous\n                    </div>` : \'\'}\n                </div>\n                <div class="summary-card manual" onclick="setCardFilter(\'status\', \'MANUAL\')">\n                    <div class="summary-value">${s.manual}</div>\n                    <div class="summary-label">Manual Reviews</div>\n                </div>\n                <div class="summary-card fixed" onclick="setCardFilter(\'delta\', \'fixed\')">\n                    <div class="summary-value">${s.fixed}</div>\n                    <div class="summary-label">Issues Fixed</div>\n                    ${cmp ? \'<div class="summary-delta positive">Remediated</div>\' : \'\'}\n                </div>\n                <div class="summary-card new-fail" onclick="setCardFilter(\'delta\', \'new-fail\')">\n                    <div class="summary-value">${s.newFail}</div>\n                    <div class="summary-label">New Failures</div>\n                    ${cmp && s.newFail > 0 ? \'<div class="summary-delta negative">New</div>\' : \'\'}\n                </div>\n            `;\n        }\n\n        function renderSeverity() {\n            const s = getActiveStats();\n            document.getElementById(\'severityGrid\').innerHTML = `\n                <div class="summary-card critical" onclick="setCardFilter(\'severity\', \'critical\')">\n                    <div class="summary-value">${s.critical}</div>\n                    <div class="summary-label">Critical</div>\n                </div>\n                <div class="summary-card high" onclick="setCardFilter(\'severity\', \'high\')">\n                    <div class="summary-value">${s.high}</div>\n                    <div class="summary-label">High</div>\n                </div>\n                <div class="summary-card medium" onclick="setCardFilter(\'severity\', \'medium\')">\n                    <div class="summary-value">${s.medium}</div>\n                    <div class="summary-label">Medium</div>\n                </div>\n                <div class="summary-card low" onclick="setCardFilter(\'severity\', \'low\')">\n                    <div class="summary-value">${s.low}</div>\n                    <div class="summary-label">Low</div>\n                </div>\n            `;\n        }\n\n        function renderCharts() {\n            const s = getActiveStats();\n            const failPct = s.total ? Math.round((s.fail / s.total) * 100) : 0;\n            const passPct = s.total ? Math.round((s.pass / s.total) * 100) : 0;\n\n\n            const byAcct = activeTab === \'all\' ? DATA.byAccount : {};\n\n\n            const activeFindings = getActiveFindings();\n            const svcMap = {};\n            activeFindings.forEach(f => {\n                if (f.status === \'FAIL\') {\n                    const svc = f.service || \'Unknown\';\n                    svcMap[svc] = (svcMap[svc] || 0) + 1;\n                }\n            });\n            const bySvc = Object.entries(svcMap)\n                .sort((a, b) => b[1] - a[1])\n                .slice(0, 6)\n                .map(([name, fail]) => ({ name, fail }));\n            const maxFails = bySvc.length ? Math.max(...bySvc.map(x => x.fail)) : 0;\n\n            document.getElementById(\'chartsRow\').innerHTML = `\n                <div class="chart-card">\n                    <div class="chart-title">Status Distribution</div>\n                    <div class="donut-container">\n                        <div class="donut" style="background: conic-gradient(\n                            var(--accent-red) 0% ${failPct}%,\n                            var(--accent-green) ${failPct}% ${failPct + passPct}%,\n                            var(--accent-yellow) ${failPct + passPct}% 100%\n                        );">\n                            <div class="donut-center">\n                                <div class="donut-center-value">${s.total}</div>\n                                <div class="donut-center-label">Total</div>\n                            </div>\n                        </div>\n                        <div class="donut-legend">\n                            <div class="legend-item"><span class="legend-dot fail"></span>${s.fail} Fail (${failPct}%)</div>\n                            <div class="legend-item"><span class="legend-dot pass"></span>${s.pass} Pass (${passPct}%)</div>\n                            <div class="legend-item"><span class="legend-dot manual"></span>${s.manual} Manual</div>\n                        </div>\n                    </div>\n                </div>\n                ${activeTab === \'all\' ? `<div class="chart-card">\n                    <div class="chart-title">By Account</div>\n                    <div class="bar-chart">\n                        ${Object.entries(byAcct).map(([name, v]) => {\n                const t = v.fail + v.pass;\n                const fp = t ? Math.round((v.fail / t) * 100) : 0;\n                return `<div class="bar-item">\n                                <span class="bar-label">${name}</span>\n                                <div class="bar-track"><div class="bar-fill fail" style="width:${fp}%"></div></div>\n                                <span class="bar-value">${v.fail}/${t}</span>\n                            </div>`;\n            }).join(\'\')}\n                    </div>\n                </div>` : `<div class="chart-card">\n                    <div class="chart-title">Severity Distribution</div>\n                    <div class="bar-chart">\n                        ${[\n                    { name: \'Critical\', count: s.critical || 0, cls: \'critical\' },\n                    { name: \'High\', count: s.high || 0, cls: \'high\' },\n                    { name: \'Medium\', count: s.medium || 0, cls: \'medium\' },\n                    { name: \'Low\', count: s.low || 0, cls: \'low\' }\n                ].map(sev => {\n                    const maxSev = Math.max(s.critical || 0, s.high || 0, s.medium || 0, s.low || 0) || 1;\n                    const w = Math.round((sev.count / maxSev) * 100);\n                    return `<div class="bar-item">\n                                <span class="bar-label">${sev.name}</span>\n                                <div class="bar-track"><div class="bar-fill ${sev.cls}" style="width:${w}%"></div></div>\n                                <span class="bar-value">${sev.count}</span>\n                            </div>`;\n                }).join(\'\')}\n                    </div>\n                </div>`}\n                <div class="chart-card">\n                    <div class="chart-title">Top Failing Services</div>\n                    <div class="bar-chart">\n                        ${bySvc.map(x => {\n                    const w = maxFails ? Math.round((x.fail / maxFails) * 100) : 0;\n                    return `<div class="bar-item">\n                                <span class="bar-label" title="${x.name}">${truncate(x.name, 12)}</span>\n                                <div class="bar-track"><div class="bar-fill fail" style="width:${w}%"></div></div>\n                                <span class="bar-value">${x.fail}</span>\n                            </div>`;\n                }).join(\'\')}\n                    </div>\n                </div>\n            `;\n        }\n\n        function populateFilters() {\n            const acctSel = document.getElementById(\'filterAccount\');\n            Object.entries(DATA.accounts).forEach(([id, info]) => {\n                acctSel.innerHTML += `<option value="${id}">${info.short} (${id.slice(-4)})</option>`;\n            });\n            const regSel = document.getElementById(\'filterRegion\');\n            (DATA.regions || []).forEach(r => {\n                regSel.innerHTML += `<option value="${r}">${r}</option>`;\n            });\n            const svcSel = document.getElementById(\'filterService\');\n            (DATA.services || []).forEach(s => {\n                svcSel.innerHTML += `<option value="${s}">${s}</option>`;\n            });\n        }\n\n        function applyFilters() {\n            let acct = document.getElementById(\'filterAccount\').value;\n            let status = document.getElementById(\'filterStatus\').value;\n            let severity = document.getElementById(\'filterSeverity\').value;\n            let region = document.getElementById(\'filterRegion\').value;\n            let service = document.getElementById(\'filterService\').value;\n            let search = document.getElementById(\'filterSearch\').value.toLowerCase();\n\n\n\n\n\n            if (activeCardFilter) {\n                if (activeCardFilter.type === \'status\') status = activeCardFilter.value;\n                if (activeCardFilter.type === \'severity\') {\n                    severity = activeCardFilter.value;\n                    status = \'FAIL\';\n                }\n            }\n\n\n            filtered = getActiveFindings().filter(r => {\n                if (acct && r.acctId !== acct) return false;\n                if (status && r.status !== status) return false;\n                if (severity && r.severity !== severity) return false;\n                if (region && r.region !== region) return false;\n                if (service && r.service !== service) return false;\n\n                if (search) {\n                    const hay = [\n                        r.id, r.title, r.resource, r.resourceName, r.statusExt,\n                        r.profile || \'\', r.mitre ? r.mitre.join(\' \') : \'\'\n                    ].join(\' \').toLowerCase();\n\n\n                    const terms = search.split(/\\s+/);\n                    return terms.every(term => hay.includes(term));\n                }\n                return true;\n            });\n            renderTable();\n        }\n\n        function resetFilters() {\n            clearCardFilter();\n            [\'filterAccount\', \'filterStatus\', \'filterSeverity\', \'filterRegion\', \'filterService\'].forEach(id => {\n                document.getElementById(id).value = \'\';\n            });\n            document.getElementById(\'filterSearch\').value = \'\';\n            applyFilters();\n        }\n\n        function getAcctClass(acctId) {\n            const keys = Object.keys(DATA.accounts);\n            const idx = keys.indexOf(acctId);\n            return acctClasses[idx % acctClasses.length];\n        }\n\n        function renderTable() {\n            const tbody = document.getElementById(\'tableBody\');\n            const info = document.getElementById(\'resultInfo\');\n            info.textContent = `${filtered.length} results`;\n\n            if (!filtered.length) {\n                tbody.innerHTML = \'<tr><td colspan="6" class="empty-state">No results</td></tr>\';\n                return;\n            }\n\n            tbody.innerHTML = filtered.map((r, i) => {\n                const deltaTag = r.delta === \'fixed\' ? \'<span class="badge-sm fixed">FIXED</span>\' :\n                    r.delta === \'new-fail\' ? \'<span class="badge-sm new">NEW</span>\' : \'\';\n                let metaBadges = \'\';\n                if (r.profile) {\n\n                }\n                if (r.mitre && r.mitre.length) {\n                    metaBadges += \'<div class="meta-badges">\';\n                    r.mitre.forEach(m => {\n\n                        const url = `https://attack.mitre.org/techniques/${m.replace(\'.\', \'/\')}/`;\n                        metaBadges += `<a href="${url}" target="_blank" class="badge mitre" onclick="event.stopPropagation()">${m}</a>`;\n                    });\n                    metaBadges += \'</div>\';\n                }\n                const sevBadge = r.severity ? `<span class="severity-badge ${r.severity}">${r.severity}</span>` : \'<span class="severity-badge">-</span>\';\n                return `<tr data-idx="${i}">\n                    <td>\n                        <span class="check-id">${esc(r.id)}</span>\n                        <div style="margin-top:4px;display:flex;gap:4px;flex-wrap:wrap">\n                            ${metaBadges}\n                        </div>\n                    </td>\n                    <td>\n                        <div>${esc(truncate(r.title, 50))}</div>\n                        <div class="check-desc">${esc(truncate(r.statusExt, 40))}</div>\n                    </td>\n                    <td><span class="badge ${r.status.toLowerCase()}">${r.status}</span>${deltaTag}</td>\n                    <td>${sevBadge}</td>\n                    <td><span class="account-tag ${getAcctClass(r.acctId)}">${DATA.accounts[r.acctId]?.short || r.acctId.slice(-6)}</span></td>\n                    <td><span class="service-tag">${r.service || \'-\'}</span></td>\n                </tr>`;\n            }).join(\'\');\n\n            tbody.querySelectorAll(\'tr\').forEach(tr => {\n                tr.addEventListener(\'click\', () => showDetail(filtered[+tr.dataset.idx]));\n            });\n        }\n\n        function showDetail(r) {\n            document.getElementById(\'detailTitle\').textContent = `${r.id} - ${truncate(r.title, 45)}`;\n            const sevBadge = r.severity ? `<span class="severity-badge ${r.severity}">${r.severity.toUpperCase()}</span>` : \'\';\n            document.getElementById(\'detailBody\').innerHTML = `\n                <div class="detail-grid">\n                    <div class="detail-block">\n                        <h4>Status</h4>\n                        <p>\n                            <span class="badge ${r.status.toLowerCase()}">${r.status}</span>\n                            ${r.delta === \'fixed\' ? \'<span class="badge-sm fixed">FIXED</span>\' : \'\'}\n                            ${r.delta === \'new-fail\' ? \'<span class="badge-sm new">NEW</span>\' : \'\'}\n                            ${r.oldStatus ? `<br><small style="color:var(--text-muted)">Was: ${r.oldStatus}</small>` : \'\'}\n                        </p>\n                    </div>\n                    <div class="detail-block">\n                        <h4>Severity</h4>\n                        <p>${sevBadge || \'N/A\'}</p>\n                    </div>\n                    <div class="detail-block">\n                        <h4>Account & Region</h4>\n                        <p>\n                            <span class="account-tag ${getAcctClass(r.acctId)}">${DATA.accounts[r.acctId]?.short || r.acctId}</span>\n                            <span style="margin:0 6px;color:var(--text-muted)">|</span>\n                            <span class="region-text">${r.region}</span>\n                        </p>\n                    </div>\n                    <div class="detail-block">\n                        <h4>Service</h4>\n                        <p><span class="service-tag">${r.service || \'N/A\'}</span></p>\n                    </div>\n                    <div class="detail-block full">\n                        <h4>Resource</h4>\n                        <p><code>${esc(r.resource)}</code></p>\n                        ${r.resourceName ? `<p style="margin-top:4px;color:var(--text-muted)">${esc(r.resourceName)}</p>` : \'\'}\n                    </div>\n                    <div class="detail-block full">\n                        <h4>Status Details</h4>\n                        <p>${esc(r.statusExt)}</p>\n                    </div>\n                    ${r.risk ? `<div class="detail-block full">\n                        <h4>Risk</h4>\n                        <p>${esc(r.risk)}</p>\n                    </div>` : \'\'}\n                    ${r.remediation ? `<div class="detail-block full">\n                        <h4>Remediation</h4>\n                        <pre>${esc(r.remediation)}</pre>\n                        ${r.remediationUrl ? `<p style="margin-top:8px"><a href="${esc(r.remediationUrl)}" target="_blank">Documentation</a></p>` : \'\'}\n                    </div>` : \'\'}\n                </div>\n            `;\n            document.getElementById(\'detailOverlay\').style.display = \'block\';\n        }\n\n        function closeModal() {\n            document.getElementById(\'detailOverlay\').style.display = \'none\';\n        }\n\n        function esc(s) {\n            if (!s) return \'\';\n            return s.replace(/&/g, \'&amp;\').replace(/</g, \'&lt;\').replace(/>/g, \'&gt;\').replace(/"/g, \'&quot;\');\n        }\n\n        function truncate(s, n) {\n            if (!s) return \'\';\n            return s.length > n ? s.slice(0, n) + \'...\' : s;\n        }\n\n\n        init();\n    </script>\n    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>\n\n</body>\n\n</html>' : JSON Data block missing from output

----------------------------------------------------------------------
Ran 2 tests in 0.002s

FAILED (failures=1)
